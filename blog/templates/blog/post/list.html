{% extends "blog/base.html" %}
{% load blog_tags %}
{% block title %}My Blog{% endblock %}
{% block content %}
<div class="nyt-grid">
    <div class="nyt-main">
        {% if tag %}
        <h2>Posts tagged with "{{ tag.name }}"</h2>
        {% endif %}
        {% for post in posts %}
        <article class="nyt-article">
            {% if post.image %}
            <img src="{{ post.image.url }}" alt="{{ post.title }}" class="nyt-image">
            {% endif %}
            <h2><a href="{{ post.get_absolute_url }}">{{ post.title }}</a></h2>
            <p class="date">Published {{ post.publish }} by {{ post.author }}</p>
            {{ post.body|markdown|truncatewords_html:30 }}
        </article>
        {% endfor %}
        {% include "pagination.html" with page=posts %}
    </div>

    <aside class="nyt-sidebar">
        <h3>Latest Posts</h3>
        {% show_latest_posts 5 %}
        <h3>Most Commented</h3>
        {% get_most_commented_posts as most_commented_posts %}
        <ul>
            {% for post in most_commented_posts %}
            <li><a href="{{ post.get_absolute_url }}">{{ post.title }}</a></li>
            {% endfor %}
        </ul>
    </aside>
</div>
{% endblock %}
